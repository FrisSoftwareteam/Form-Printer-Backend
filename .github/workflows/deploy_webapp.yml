name: Build and deploy to Azure Web App (Form-Print-Backend)
on:
push:
branches: [ main ]
workflow_dispatch:
env:
NODE_VERSION: '20.x'
NODE_ENV: production
jobs:
build:
runs-on: ubuntu-latest
steps:
- uses: actions/checkout@v4
- uses: actions/setup-node@v4
with:
node-version: ${{ env.NODE_VERSION }}
- run: npm ci
- run: npm run build
- name: Prepare runtime package
run: |
mkdir -p deploy
cp -r dist package.json package-lock.json deploy/
cd deploy
npm ci --omit=dev
zip -r ../release.zip .
- uses: actions/upload-artifact@v4
with:
name: webapp
path: release.zip

deploy:
runs-on: ubuntu-latest
needs: build
permissions:
contents: read
steps:
- uses: actions/download-artifact@v4
with:
name: webapp
- run: unzip release.zip -d package && rm release.zip
- name: Deploy to App Service
uses: azure/webapps-deploy@v2
with:
app-name: Form-Print-Backend
package: package
publish-profile: ${{ secrets.AZUREAPPSERVICE_PUBLISHPROFILE }}